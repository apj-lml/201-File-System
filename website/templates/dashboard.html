{% extends 'base.html' %}

{% block title %} NIA PIMO {% endblock %}

{% block cssperfile %} 
    <style rel="stylesheet">
        select.birthday-select{
            border: none;
            background-color:transparent;
            font-weight: bold;
            /* font-style: italic; */
            text-align: left;
            color: rgb(51,10,113);
            color: linear-gradient(152deg, rgba(51,10,113,0.9192051820728291) 3%, rgba(0,5,121,0.8127626050420168) 37%, rgba(34,76,199,1) 98%);
            /* width: auto; */
        }

        .paragraph {
            overflow: hidden;
            max-height: 300px;
            transition: max-height 0.3s ease-out;
        }

        #read-more-btn,
        #read-less-btn {
            display: none;
            cursor: pointer;
            color: rgb(51,10,113);
            color: linear-gradient(152deg, rgba(51,10,113,0.9192051820728291) 3%, rgba(0,5,121,0.8127626050420168) 37%, rgba(34,76,199,1) 98%);
            /* width: auto; */
        }
        
    </style>
{% endblock %}

{% block content %}
        <!-- Navigation-->
        <!-- <nav class="navbar navbar-light bg-light static-top">
            <div class="container">
                <a class="navbar-brand" href="#!">Start Bootstrap</a>
                <a class="btn btn-primary" href="#signup">Sign Up</a>
            </div>
        </nav> -->
		
        <!-- Masthead-->
        <div class="container-fluid vw-100 p-0 w-0">
            <header class="masthead pt-5 col-sm-12 me-0 w-100 vh-100">
                <div class="container position-relative">
                    <div class="row justify-content-center">
                        <div class="col-xl-12">
                            <div class="text-center text-white">
                                <!-- Page heading-->
                                <img src="{{url_for('static', filename='img/nia-logo.png')}}" alt="" width="250px" height="250px" class="d-inline-block align-text-center mb-5">
                                                    
                                <h1 class="mb-5 mt-0 text-white trajan"><span style="font-size: larger;">PANGASINAN</span> <br> IRRIGATION MANAGEMENT OFFICE</h1>
                                <p class="fs-5"><i id="quote"></i></p>
                                <p class="text-center" style="font-size: large;"><b id="qauthor"></b></p>
                            </div>
                        </div>
                    </div>
                </div>
            </header>
            <!-- Icons Grid-->
            <div class="col-sm-12">
                <section class="features-icons bg-light text-center pt-5 mt-5">
                    <div class="container">
                        <div class="row">
                            <div class="col-lg-3">
                                <div class="features-icons-item mx-auto mb-0 mb-lg-3">
                                    <div class="features-icons-icon d-flex"><a href="#valueFocus" class="mx-auto" id="valueFocusBtn"><i class="bi bi-heart-fill m-auto text-blue"></i></a></div>
                                    <h4>Value Focus</h4>
                                    <p class="lead mb-0">Weekly value focus - anytime, anywhere.</p>
                                </div>
                            </div>
                            <div class="col-lg-3">
                                <div class="features-icons-item mx-auto mb-0 mb-lg-3">
                                    <div class="features-icons-icon d-flex"><a href="#mission" class="mx-auto"><i class="bi bi-graph-up-arrow m-auto text-blue"></i></a></div>
                                    <h4>Mission</h4>
                                    <p class="lead mb-0">Look at NIA's mission.</p>
                                </div>
                            </div>
                            <div class="col-lg-3">
                                <div class="features-icons-item mx-auto mb-0 mb-lg-3">
                                    <div class="features-icons-icon d-flex"><a href="#vision" class="mx-auto"><i class="bi bi-eye-fill m-auto text-blue"></i></a></div>
                                    <h4>Vision </h4>
                                    <p class="lead mb-0">Look at NIA's vision.</p>
                                </div>
                            </div>
                            <div class="col-lg-3">
                                <div class="features-icons-item mx-auto mb-0 mb-lg-3">
                                    <div class="features-icons-icon d-flex"><a href="#birthdays" class="mx-auto"><i class="bi bi-cake text-blue"></i></a></div>
                                    <h4>Birthdays</h4>
                                    <p class="lead mb-0">See whose birthday today and greet them!</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>
            </div> 


            <section class="showcase">
                <div class="container-fluid p-0">
                    <div class="row g-0"  id="valueFocus">
                        <div class="col-lg-6 order-lg-2 text-white showcase-img text-center">
                            <img class="img-fluid" src="https://www.crfv-cpu.org{{ blog_image['src'] }}"/>
                            <!-- <img class="img-fluid" src="https://www.crfv-cpu.org{{ blog_image['src'] }}" width="450px;" height="450px;"/> -->
                        </div>
                        <div class="col-lg-6 order-lg-1 my-auto showcase-text">
                            <h2>{{ blog_title[0] | safe }}</h2>
                            {{ blog_paragraph | safe}}
                            <div class="lead mb-0" id="blog-content"></div>
                            <span id="dots">
                                <p id="read-more-btn" onclick="toggleReadMore()">...Read More</p>
                                <p id="read-less-btn" onclick="toggleReadMore()">Read Less...</p>
                            </span>

                        </div>

                    </div>
                    <div class="row g-0" id="mission">
                            <div class="col-lg-6 text-white showcase-img">
                            <img class="img-fluid" src="{{ url_for('static', filename='img/mission.jpg') }}" loading="lazy" alt="mission" />
                        </div>
                        <div class="col-lg-6 my-auto showcase-text">
                            <h2>Mission</h2>
                            <p class="lead mb-0">To plan, construct, operate and maintain irrigation systems consistent with integrated water resource management principles to improve agricultural productivity and increase farmers' income.</p>
                        </div>
                    </div>
                    <div class="row g-0" id="vision">
                        <!-- <div class="col-lg-6 order-lg-2 text-white showcase-img" style="background-image: url('assets/img/bg-showcase-3.jpg')"></div> -->
                        <div class="col-lg-6 order-lg-2 text-white showcase-img">
                            <img class="img-fluid" src="{{ url_for('static', filename='img/vision.png') }}" loading="lazy" alt="vision"/>
                        </div>
                        <div class="col-lg-6 order-lg-1 my-auto showcase-text">
                            <h2>Vision</h2>
                            <p class="lead mb-0">By 2022, NIA is a professional and efficient irrigation agency contributing to the inclusive growth of the country and in the improvement of the farmers' quality of life.</p>
                        </div>
                    </div>
                    <div class="row g-0" id="birthdays" >
                        <!-- <div class="col-lg-6 text-white showcase-img" style="background-image: url('{{ url_for('static', filename='img/mission.png') }}')"> -->
                            <div class="col-lg-6 text-white showcase-img">
                            <!-- <img class="img-fluid" src="{{ url_for('static', filename='img/mission.jpg') }}"/> -->
                              <div id="carouselExampleControls" class="carousel carousel-dark slide carousel-fade" data-bs-ride="carousel" >
                                <div class="carousel-inner">
                                    {% for celebs in bday_celebs %}
                                    <div class="carousel-item {{ 'active' if loop.index == 1 }}">
                                      <img src="{{ url_for('static', filename='img/birthday/' + loop.index|string + '.png') }}" class="d-block w-100" loading="lazy" alt="birthdays">
                                    </div>
                                  {% endfor %}
                                </div>
                                <button class="carousel-control-prev" type="button" data-bs-target="#carouselExampleControls" data-bs-slide="prev">
                                  <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                                  <span class="visually-hidden">Previous</span>
                                </button>
                                <button class="carousel-control-next" type="button" data-bs-target="#carouselExampleControls" data-bs-slide="next">
                                  <span class="carousel-control-next-icon" aria-hidden="true"></span>
                                  <span class="visually-hidden">Next</span>
                                </button>
                              </div>
                        </div>
                        <div class="col-lg-6 showcase-text">
                            <h2>Birtday Celebrators</h2>
                            <h4>
                                Month of 
                                 <select name="" id="birthday-select" value="{{ today_date.strftime('%m') }}" class="birthday-select">
                                     <option value="{{ today_date.strftime('%m') }}" selected hidden>{{ today_date.strftime('%B') }}</option>
                                     <option value="01">January</option>
                                     <option value="02">February</option>
                                     <option value="03">March</option>
                                     <option value="04">April</option>
                                     <option value="05">May</option>
                                     <option value="06">June</option>
                                     <option value="07">July</option>
                                     <option value="08">August</option>
                                     <option value="09">September</option>
                                     <option value="10">October</option>
                                     <option value="11">November</option>
                                     <option value="12">December</option>
                                 </select>
                            </h4>
                             <ul id="listOfBirthdayCelebrators">
                                 {% for celebs in bday_celebs %}
                                     <li>{{celebs.birthdate.strftime('%d')}} &#8212; {{celebs.last_name}}, {{celebs.first_name}} {{ "" if celebs.name_extn is none or celebs.name_extn == "" or celebs.name_extn == "N/A" else celebs.name_extn }} {{ celebs.middle_name if celebs.middle_name is none or celebs.middle_name == "" or celebs.middle_name == "N/A" else celebs.middle_name }}</li>
                                 {% endfor %}
                             </ul>
                        </div>
                    </div>
                </div>
            </section>

<!--             
            <section class="showcase col-sm-12 w-100">
                <div class="container-fluid p-0">
                    <div class="row g-0">

                        <div class="col-lg-6 col-sm-12 order-lg-1 showcase-text" id="contactInformation">
                            <h2><i class="bi bi-telephone-fill"></i> PIMO Telephone Directory</h2>
                                <div class="table-responsive">
                                    <table class="table table-bordered table-striped text-center nowrap" id="pimoTelephoneDirectory" width = "100%">
                                      <thead class="">
                                      <tr class="align-middle">
                                        <th>Name</th>
                                        <th>Emergency No.</th>
                                      </tr>
                                      </thead>
                                      <tbody>
                                        <tr>
                                            <td class="text-start">[PIMO] Office of the Irrigation Manager</td>
                                            <td class="text-start"><a href="tel:+(075) 632-2775">(075) 632-2775</a></td>
                                        </tr>
                                        <tr>
                                            <td class="text-start">[PIMO] Administrative Unit</td>
                                            <td class="text-start"><a href="tel:+(075) 505-1550">(075) 505-1550</a></td>
                                        </tr>
                                        <tr>
                                            <td class="text-start">[PIMO] Finance Unit</td>
                                            <td class="text-start"><a href="tel:+(075) 632-5149">(075) 632-5149</a></td>
                                        </tr>
                                        <tr>
                                            <td class="text-start">[PIMO] Property Unit</td>
                                            <td class="text-start"><a href="tel:+(075) 615-2106">(075) 615-2106</a></td>
                                        </tr>
                                        <tr>
                                            <td class="text-start">[PIMO] Institutional Development Unit</td>
                                            <td class="text-start"><a href="tel:+(075) 540-1391">(075) 540-1391</a></td>
                                        </tr>
                                        <tr>
                                            <td class="text-start">[PIMO] Agno-Sinocalan RIS (ASRIS)</td>
                                            <td class="text-start"><a href="tel:+(075) 632-1801">(075) 632-1801</a></td>
                                        </tr>
                                        <tr>
                                            <td class="text-start">[PIMO] Ambayoan-Dipalo RIS (ADRIS)</td>
                                            <td class="text-start"><a href="tel:+(075) 633-3341">(075) 633-3341</a></td>
                                        </tr>
                                        <tr>
                                            <td class="text-start">[PIMO] Lower Agno RIS (LARIS)</td>
                                            <td class="text-start"><a href="tel:+(075) 632-7702">(075) 632-7702</a></td>
                                        </tr>
                                        <tr>
                                            <td class="text-start">[PIMO] San Fabian-Dumuloc RIS (SFDRIS)</td>
                                            <td class="text-start"><a href="tel:+(075) 511-4300">(075) 511-4300</a></td>
                                        </tr>
                                        <tr>
                                            <td class="text-start">[RO] Regional Irrigation Manager</td>
                                            <td class="text-start"><a href="tel:+(075) 632-2776">(075) 632-2776</a> | <a href="tel:+(075) 633-7130">(075) 633-7130</a></td>
                                        </tr>
                                        <tr>
                                            <td class="text-start">[RO] Finance Section</td>
                                            <td class="text-start"><a href="tel:+(075) 632-2776">(075) 632-2776</a></td>
                                        </tr>
                                        <tr>
                                            <td class="text-start">[RO] Administrative Section</td>
                                            <td class="text-start"><a href="tel:+(075) 632-7042">(075) 632-7042</a></td>
                                        </tr>
                                        <tr>
                                            <td class="text-start">[RO] Institutional Development Section (IDS)</td>
                                            <td class="text-start"><a href="tel:+(075) 568-7522">(075) 568-7522</a></td>
                                        </tr>
                                        <tr>
                                            <td class="text-start">[RO] Engineering & Operations Division (EOD)</td>
                                            <td class="text-start"><a href="tel:+(075) 632-1435">(075) 632-1435</a></td>
                                        </tr>
                                        <tr>
                                            <td class="text-start">[RO] Equipment Management Section (EMS)</td>
                                            <td class="text-start"><a href="tel:+(075) 632-2582">(075) 632-2582</a></td>
                                        </tr>
                                        <tr>
                                            <td class="text-start">[RO] Commission on Audit (COA)</td>
                                            <td class="text-start"><a href="tel:+(075) 568-2114">(075) 568-2114</a></td>
                                        </tr>
                                        <tr>
                                            <td class="text-start">[LUIMO] La Union IMO</td>
                                            <td class="text-start"><a href="tel:+(072) 687-0703">(072) 687-0703</a></td>
                                        </tr>
                                        <tr>
                                            <td class="text-start">[INIMO] Ilocos Norte IMO</td>
                                            <td class="text-start"><a href="tel:+(077) 676-1979">(077) 676-1979</a></td>
                                        </tr>
                                        <tr>
                                            <td class="text-start">[ISIMO] Ilocos Sur IMO</td>
                                            <td class="text-start"><a href="tel:+(077) 604-0423">(077) 604-0423</a></td>
                                        </tr>
                                        <tr>
                                            <td class="text-start">[CO] OFFICE OF THE PUBLIC AFFAIRS AND INFORMATION STAFF (PAIS) </td>
                                            <td class="text-start"><a href="tel:+(077) 604-0423">(077) 604-0423</a></td>
                                        </tr> 
                                      </tbody>
                                    </table>
                                  </div>
                        </div>
                        <div class="col-lg-6 col-sm-12 order-lg-1 showcase-text">
                            <h2><i class="bi bi-telephone-fill"></i> Emergency Hotlines</h2>
                                <div class="table-responsive">
                                    <table class="table table-bordered table-striped text-center nowrap" id="emergencyHotlineTable" width = "100%">
                                      <thead class="">
                                      <tr class="align-middle">
                                        <th>Name</th>
                                        <th>Contact No.</th>
                                      </tr>
                                      </thead>
                                      <tbody>
                                        <tr>
                                            <td class="text-start">PNP URDANETA CITY</td>
                                            <td class="text-start"> GLOBE: <a href="tel:+0916-226-3641">0916-226-3641</a> <br>
                                                 SMART: <a href="tel:+0998-598-5134">0998-598-5134</a>
                                            </td>
                                          </tr>
                                          <tr>
                                            <td class="text-start">BFP URDANETA CITY</td>
                                            <td class="text-start">GLOBE: <a href="tel:+0917-184-4611">0917-184-4611</a></td>
                                          </tr>
                                          <tr>
                                            <td class="text-start">URDANETA CITY HEALTH OFFICE</td>
                                            <td class="text-start">SMART: <a href="tel:+0933-869-4961">0933-869-4961</a></td>
                                          </tr>
                                          <tr>
                                            <td class="text-start">EMERGENCY MEDICAL SERVICES</td>
                                            <td class="text-start">GLOBE: <a href="tel:+0917-818-5374">0917-818-5374</a></td>
                                          </tr>
                                          <tr>
                                            <td class="text-start">SACRED HEART HOSPITAL</td>
                                            <td class="text-start">TELEPHONE: <a href="tel:+(075) 568 2294">(075) 568 2294</a> | <a href="tel:+(075) 656 2296">(075) 656 2296</a></td>
                                          </tr>
                                          <tr>
                                            <td class="text-start">URDANETA EMERGENCY DISTRICT HOSPITAL</td>
                                            <td class="text-start">GLOBE: <a href="tel:+0927-637-1446">0927-637-1446</a> | <a href="tel:+0917-702-9318">0917-702-9318</a> <br>
                                                SMART: <a href="tel:+0933-874-2503">0933-874-2503</a> | <a href="tel:+0933-874-2503">0917-677-6007</a>
                                            </td>
                                          </tr>                           
                                      </tbody>
                                    </table>
                                  </div>
                        </div>
                    </div>
    
                    </div>
            </section> 

>-->


        <!-- Call to Action-->
        <section class="call-to-action text-white text-center col-sm-12">
            <div class="container position-relative">
                <div class="row justify-content-center">
                    <div class="col-xl-6">
                        <img src="{{url_for('static', filename='img/nia-logo.png')}}" alt="" width="150px" height="150px" class="d-inline-block align-text-center mb-2">
                        <h2 class="mb-4 trajan text-white">PANGASINAN <br> IRRIGATION MANAGEMENT OFFICE</h2>
                        
                    </div>
                </div>
            </div>
        </section>
        <!-- Footer-->


        </div>
     




		{% endblock %}

        {% block scripts %}


        <script type="application/javascript">

            document.getElementById('birthday-select').addEventListener('change',(e)=>{
                document.getElementById("listOfBirthdayCelebrators").innerHTML = ``;

                let month = document.getElementById('birthday-select');
                fetch(`/birthday-celebrators/${month.value}`,{
                    method: 'GET',
                    // body: JSON.stringify({"id" : el.id})
                })
                    .then(response => response.json())
                    .then(data => {
                        
                        data.forEach(element => {
                            var date = new Date(element.birthdate);
                            day = date.toLocaleDateString(undefined, { // you can use undefined as first argument
                                        year: "numeric",
                                        month: "2-digit",
                                        day: "2-digit",})
                                        // .getDate();
                            day = day.split("/")

                            document.getElementById("listOfBirthdayCelebrators").innerHTML += `
                            <li>${day[1]} &#8212; ${element.last_name}, ${element.first_name} ${(element.name_extn == null || element.name_extn == "N/A" || element.name_extn == "") ? "" : element.name_extn} ${(element.middle_name == null || element.middle_name == "N/A" || element.middle_name == "") ? "" : element.middle_name}</li>
                            `
                        });
                        // document.getElementById("update_id").value = data[0].id;
                        // document.getElementById("update_fullname").value = data[0].fullname;
                        // document.getElementById("update_address").value = data[0].address;
                        // document.getElementById("update_contact_no").value = data[0].contact_no;
                    });
            });


            function countWords(text) {
                return text.split(/\s+/).filter(Boolean).length;
            }

            function toggleReadMore() {
                //var content = document.getElementById('blog-content');
                var content = document.getElementsByClassName("paragraph");
                var readMoreBtn = document.getElementById('read-more-btn');
                var readLessBtn = document.getElementById('read-less-btn');
                var valueFocus = document.getElementById('valueFocusBtn');

             if(content[0].style.maxHeight == '100%'){
                    content[0].style.maxHeight = '300px';
                    readMoreBtn.style.display = 'block';
                    readLessBtn.style.display = 'none';
                    valueFocus.click();

                
                } else {
                    content[0].style.maxHeight = '100%';
                    readMoreBtn.style.display = 'none';
                    readLessBtn.style.display = 'block';
                }
            }

        // Check if content has more than 100 words
        // var content = document.getElementById('content');
        var content = document.getElementsByClassName("paragraph");

        var readMoreBtn = document.getElementById('read-more-btn');
        if (countWords(content[0].textContent) > 40) {
            content[0].style.maxHeight = '300px';
            readMoreBtn.style.display = 'block';
        }


            window.addEventListener('load', (event) => {

                $(document).ready(function(){
                    $("#searchFormsInput").on("keyup", function() {
                      var value = $(this).val().toLowerCase();
                      $("#searchFormsList li").filter(function() {
                        $(this).toggle($(this).text().toLowerCase().indexOf(value) > -1)
                      });
                    });
                  });

            new DataTable('#emergencyHotlineTable');
            new DataTable('#pimoTelephoneDirectory');

                fetch('https://api.quotable.io/random?tags=inspirational',{
                    method: 'GET',
                    //body: JSON.stringify({"tags" : "inspirational, famous-quotes"})
                })
                    .then(response => response.json())
                    .then((data)=>{
                        if(data.content != undefined){
                            document.getElementById("quote").innerHTML = '"'+ data.content +'"';
                            document.getElementById("qauthor").innerHTML = '-'+ data.author;
                        }

                })

                var selectId = document.getElementById("birthday-select");

                selectId.onchange=function(){
                var selectedValue = selectId.options[selectId.selectedIndex].value; 
                var selectedText = selectId.options[selectId.selectedIndex].text;

                selectId.style.width = 75 + (selectedText.length * 8) + "px";
                }

                });
        </script>
        {% endblock %}